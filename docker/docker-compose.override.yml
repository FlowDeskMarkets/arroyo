services:
  arroyo-flowdesk:
    image: arroyo-flowdesk
    build:
      context: ..
      dockerfile: docker/Dockerfile.custom
      args:
        NATS_DATA_SERVERS: ${NATS_DATA_SERVERS}
        NATS_DATA_USER: ${NATS_DATA_USER}
        NATS_DATA_PASSWORD: ${NATS_DATA_PASSWORD}
        NATS_INFRA_AS: ${NATS_INFRA_AS}
        NATS_INFRA_EU: ${NATS_INFRA_EU}
        NATS_INFRA_US: ${NATS_INFRA_US}
        NATS_INFRA_USER: ${NATS_INFRA_USER}
        NATS_INFRA_PASSWORD: ${NATS_INFRA_PASSWORD}
        PROM_AUTH: ${PROM_AUTH}
        PROM_ENDPOINT: ${PROM_ENDPOINT}
        GCP_BUCKET_DATALAKE: ${GCP_BUCKET_DATALAKE}
        GOOGLE_SERVICE_ACCOUNT_KEY: ${GOOGLE_SERVICE_ACCOUNT_KEY}
        SERVICE_ACCOUNT_JSON: ${SERVICE_ACCOUNT_JSON}
        GIT_CREDENTIALS: ${GIT_CREDENTIALS}

    environment:
      - NATS_DATA_SERVERS=${NATS_DATA_SERVERS}
      - NATS_DATA_USER=${NATS_DATA_USER}
      - NATS_DATA_PASSWORD=${NATS_DATA_PASSWORD}
      - NATS_INFRA_AS=${NATS_INFRA_AS}
      - NATS_INFRA_EU=${NATS_INFRA_EU}
      - NATS_INFRA_US=${NATS_INFRA_US}
      - NATS_INFRA_USER=${NATS_INFRA_USER}
      - NATS_INFRA_PASSWORD=${NATS_INFRA_PASSWORD}
      - PROM_AUTH=${PROM_AUTH}
      - PROM_ENDPOINT=${PROM_ENDPOINT}
      - GCP_BUCKET_DATALAKE=${GCP_BUCKET_DATALAKE}
      - GOOGLE_SERVICE_ACCOUNT_KEY=${GOOGLE_SERVICE_ACCOUNT_KEY}
      - SERVICE_ACCOUNT_JSON=${SERVICE_ACCOUNT_JSON}
      - GIT_CREDENTIALS=${GIT_CREDENTIALS}
      - TEST=${TEST}
    env_file:
      - path: .env
        required: true
